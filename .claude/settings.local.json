{
  "permissions": {
    "allow": [
      "Bash(git fetch:*)",
      "Bash(git checkout:*)",
      "Bash(git pull:*)",
      "Bash(git merge:*)",
      "Bash(git push:*)",
      "Bash(cat:*)",
      "Bash(python -m pytest:*)",
      "Bash(pip install:*)",
      "Bash(git add:*)",
      "Bash(.env.example )",
      "Bash(app/api/core/config.py )",
      "Bash(app/api/core/cookie_auth.py )",
      "Bash(app/api/core/dependencies.py )",
      "Bash(app/api/core/deps.py )",
      "Bash(app/api/core/secrets_manager.py )",
      "Bash(app/api/core/security_middleware.py )",
      "Bash(app/api/core/settings.py )",
      "Bash(app/api/main.py )",
      "Bash(app/api/routers/auth.py )",
      "Bash(app/api/services/external_document_service.py )",
      "Bash(app/api/services/knowledge_article_service.py )",
      "Bash(app/api/services/mindmap_service.py )",
      "Bash(app/api/services/notification_service.py )",
      "Bash(app/api/services/security_service.py )",
      "Bash(app/src/config.py )",
      "Bash(frontend/src/services/api.ts )",
      "Bash(frontend/src/store/authStore.ts )",
      "Bash(tests/)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: Implement enterprise security hardening\n\nSecurity improvements addressing 12 critical audit findings:\n\n1. KMS/Vault Integration:\n   - Remove all hardcoded secrets from codebase\n   - Add centralized secrets_manager.py with startup validation\n   - Enforce required environment variables \\(JWT_SECRET_KEY, etc.\\)\n\n2. DEBUG Auth Bypass Removal:\n   - Remove DEBUG mode authentication bypass in deps.py\n   - Remove development mode bypass in dependencies.py\n   - Remove dev_user privilege escalations\n\n3. CSP/CORS Hardening:\n   - Add SecurityHeadersMiddleware with CSP, HSTS, X-Frame-Options\n   - Replace wildcard CORS with explicit methods/headers\n   - Environment-aware security policies\n\n4. JWT HttpOnly Cookie Migration:\n   - Add cookie_auth.py for secure token handling\n   - Set HttpOnly, Secure, SameSite=Strict cookies\n   - Remove localStorage token storage from frontend\n   - Support dual auth: cookies \\(preferred\\) + Authorization header\n\n5. Security Validation:\n   - Add comprehensive security test suite \\(27 tests\\)\n   - Validate no hardcoded secrets, headers, cookies, CORS\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git remote set-url:*)",
      "Bash(npm run build:*)",
      "Bash(npx tsc --noEmit)",
      "Bash(./node_modules/.bin/tsc:*)",
      "Bash(npm install:*)",
      "Bash(npm run dev:*)",
      "Bash(python -m py_compile:*)",
      "Bash(git commit:*)",
      "Bash(python -m app.api.main:*)",
      "Bash(curl:*)",
      "Bash(python:*)",
      "Bash(npx playwright install:*)",
      "Bash(xargs cat:*)",
      "Bash(find:*)",
      "Bash(app/api/models/preferences.py )",
      "Bash(app/api/routers/preferences.py )",
      "Bash(frontend/src/App.tsx )",
      "Bash(frontend/src/index.css )",
      "Bash(frontend/src/pages/MainDashboard.tsx )",
      "Bash(frontend/src/components/LanguageSelector.tsx )",
      "Bash(frontend/src/components/ThemeToggle.tsx )",
      "Bash(frontend/src/hooks/ )",
      "Bash(frontend/src/i18n/ )",
      "Bash(frontend/src/store/preferencesStore.ts )",
      "Bash(frontend/src/styles/)",
      "Bash(npm test:*)",
      "Bash(npm run test:run:*)",
      "Bash(VISUAL_REGRESSION=true npx playwright test:*)",
      "Bash(npx playwright:*)",
      "Bash(frontend/package.json )",
      "Bash(frontend/src/i18n/locales/en/auth.json )",
      "Bash(frontend/src/i18n/locales/ko/auth.json )",
      "Bash(frontend/src/pages/LoginPage.tsx )",
      "Bash(frontend/src/styles/themes.css )",
      "Bash(frontend/vite.config.ts )",
      "Bash(frontend/playwright.config.ts )",
      "Bash(frontend/src/__tests__/ )",
      "Bash(docs/PREVENTIVE_DESIGN_SUMMARY.md )",
      "Bash(docs/THEME_TOKENS.md)",
      "Bash(app/api/adapters/vision/ )",
      "Bash(app/api/core/vision_exceptions.py )",
      "Bash(app/api/middleware/ )",
      "Bash(app/api/models/vision.py )",
      "Bash(app/api/pipeline/vision_orchestrator.py )",
      "Bash(app/api/ports/vision_llm_port.py )",
      "Bash(app/api/routers/vision.py )",
      "Bash(app/api/services/document_analyzer.py )",
      "Bash(app/api/services/enhanced_query_router.py )",
      "Bash(app/api/services/image_preprocessor.py )",
      "Bash(app/api/services/query_visual_detector.py )",
      "Bash(app/api/services/response_normalizer.py )",
      "Bash(app/api/services/vision_cache.py )",
      "Bash(app/api/services/vision_cost_monitor.py )",
      "Bash(app/api/services/vision_health_monitor.py )",
      "Bash(app/api/services/vision_llm_factory.py )",
      "Bash(app/api/services/vision_metrics.py )",
      "Bash(app/api/services/vision_rag_integration.py )",
      "Bash(app/api/services/vision_router.py )",
      "Bash(docs/DESIGN_VISION_LLM_ROUTING.md)",
      "Bash(gh pr create:*)",
      "Bash(gh pr list:*)",
      "Bash(git remote:*)",
      "Bash(wc:*)",
      "Bash(chmod:*)",
      "Bash(.env.test )",
      "Bash(scripts/run_local_tests.sh:*)",
      "Bash(tests/conftest.py )",
      "Bash(tests/mocks/ )",
      "Bash(tests/api/ )",
      "Bash(tests/models/ )",
      "Bash(tests/services/ )",
      "Bash(frontend/src/__tests__/stores/ )",
      "Bash(frontend/src/__tests__/e2e/)",
      "Bash(where:*)",
      "Bash(winget install:*)",
      "Bash(choco install:*)",
      "Bash(scoop install:*)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" --version)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" auth status)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" auth login --with-token)",
      "Bash(https://api.github.com/repos/jeiths2202/gpubase-raphrag/pulls )",
      "Bash(https://api.github.com/repos/jeiths2202/gpubase-raphrag/pulls/1/merge )",
      "Bash(app/api/models/language_policy.py )",
      "Bash(app/api/services/rag_service.py )",
      "Bash(app/api/services/language_policy.py )",
      "Bash(frontend/src/hooks/useTranslation.ts )",
      "Bash(frontend/src/hooks/useLanguagePolicy.ts )",
      "Bash(frontend/src/hooks/useLocaleFormat.ts )",
      "Bash(frontend/src/i18n/index.ts )",
      "Bash(frontend/src/i18n/types.ts )",
      "Bash(frontend/src/i18n/locales/ja/ )",
      "Bash(frontend/src/pages/KnowledgeApp.tsx )",
      "Bash(frontend/src/utils/ )",
      "Bash(frontend/src/__tests__/utils/ )",
      "Bash(tests/models/test_language_policy.py )",
      "Bash(tests/services/test_language_policy_service.py)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" pr create --title \"feat: Implement comprehensive multilingual support \\(ja-JP, en-US, ko-KR\\)\" --body \"$\\(cat <<''EOF''\n## Summary\n\nImplements comprehensive multilingual support for the enterprise RAG KMS platform, adding Japanese language support and a complete internationalization infrastructure.\n\n### Key Features\n\n- **Japanese Language Support \\(ja-JP\\)**: 9 translation files with browser language auto-detection\n- **Locale-Specific Formatting**: Date, time, number, and currency formatting respecting locale conventions\n- **RAG Response Language Sync**: LLM prompt injection to enforce response language matching UI selection\n- **Role-Based Language Policies**: Hierarchical restrictions \\(admin: all languages â†’ guest: English only\\)\n\n### Changes\n\n| Category | Files | Description |\n|----------|-------|-------------|\n| Backend Models | 2 | `language_policy.py`, `preferences.py` |\n| Backend Services | 2 | `language_policy.py`, `rag_service.py` |\n| Backend Routes | 1 | New `/language-policy` and `/validate-language` endpoints |\n| Frontend i18n | 11 | Japanese translations \\(9\\) + types + index |\n| Frontend Hooks | 3 | `useLanguagePolicy`, `useLocaleFormat`, `useTranslation` |\n| Frontend Utils | 2 | `browserLanguage.ts`, `localeFormat.ts` |\n| Frontend Components | 2 | `LanguageSelector`, `KnowledgeApp` |\n| Tests | 4 | 89 total tests \\(38 backend + 51 frontend\\) |\n\n### Test Plan\n\n- [x] Backend unit tests: `pytest tests/models/test_language_policy.py tests/services/test_language_policy_service.py` \\(38 passed\\)\n- [x] Frontend unit tests: `npm run test:run` for localeFormat and browserLanguage utilities \\(51 passed\\)\n- [ ] Manual testing: Language switching in UI\n- [ ] Manual testing: RAG responses in selected language\n- [ ] Manual testing: Role-based language restrictions\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\nEOF\n\\)\")",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" auth login --web)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" pr merge 2 --merge)",
      "Bash(\"/c/Program Files/GitHub CLI/gh.exe\" pr view 2 --json state,mergedAt,mergedBy)",
      "Bash(git branch:*)",
      "Bash(node screenshot-languages.js:*)",
      "Bash(node test-multilingual.js:*)",
      "Bash(node test-multilingual-full.js:*)",
      "Bash(node -e:*)",
      "Bash(grep:*)",
      "Skill(commit-commands:commit)",
      "Bash(echo:*)",
      "Bash(tree:*)",
      "Bash(app/api/core/container.py )",
      "Bash(app/api/infrastructure/memory/__init__.py )",
      "Bash(app/api/infrastructure/memory/conversation_repository.py )",
      "Bash(app/api/infrastructure/postgres/ )",
      "Bash(app/api/models/conversation.py )",
      "Bash(app/api/repositories/__init__.py )",
      "Bash(app/api/repositories/conversation_repository.py )",
      "Bash(app/api/routers/conversations.py )",
      "Bash(app/api/services/conversation_rag_integration.py )",
      "Bash(app/api/services/conversation_service.py )",
      "Bash(migrations/ )",
      "Bash(tests/api/test_conversation_endpoints.py )",
      "Bash(tests/integration/ )",
      "Bash(tests/models/test_conversation_models.py )",
      "Bash(tests/services/test_conversation_service.py)",
      "Bash(tasklist:*)",
      "Bash(taskkill //F //PID 25852)",
      "Bash(taskkill //F //PID 41892)",
      "Bash(netstat:*)",
      "Bash(taskkill /F /PID 47432)",
      "Bash(taskkill //F //PID 47432)",
      "Bash(taskkill:*)",
      "Bash(timeout /t 5 /nobreak)",
      "Bash(findstr:*)",
      "Bash(timeout /t 3 /nobreak)",
      "Bash(ping:*)",
      "Bash(for pid in 31352 44268 2940 47016)",
      "Bash(do taskkill //F //PID $pid)",
      "Bash(done)",
      "Bash(for pid in 31352 44268 47016 2940 47976 26680)",
      "Bash(ls:*)",
      "Bash(set:*)",
      "Bash(uvicorn app.api.main:app:*)",
      "Bash(timeout /t 10 /nobreak)",
      "Bash(bash:*)",
      "Bash(xargs:*)",
      "Bash(for pid in 26344 26752 32672)",
      "Bash(APP_ENV=develop python:*)",
      "Bash(git log:*)",
      "Bash(pg_isready:*)",
      "Bash(psql:*)",
      "Bash(docker exec:*)",
      "Bash(docker inspect:*)",
      "Bash(timeout /t 12 /nobreak)",
      "Skill(feature-dev:feature-dev)",
      "Skill(commit-commands:commit-push-pr)",
      "Bash(lsof:*)",
      "Bash(timeout /t 8 /nobreak)",
      "Bash(powershell:*)",
      "Bash(gh pr merge:*)",
      "Bash(gh pr view:*)",
      "Bash(timeout /t 2 /nobreak)",
      "Bash(tee:*)",
      "Skill(sc:implement)",
      "Bash(export PYTHONDONTWRITEBYTECODE=1)",
      "Bash(PYTHONDONTWRITEBYTECODE=1 uvicorn:*)",
      "Bash(dir \"%LOCALAPPDATA%\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Network\")",
      "Bash(export PORT=8000)",
      "Bash(playwright install:*)",
      "Bash(dir:*)",
      "Bash(PYTHONDONTWRITEBYTECODE=1 python:*)",
      "Bash(robocopy:*)",
      "Bash(cmd //c \"robocopy \"\"C:\\\\Users\\\\yijae.shin\\\\AppData\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Network\"\" \"\"C:\\\\Users\\\\yijae.shin\\\\Downloads\\\\nim\\\\gpubase-raphrag\\\\test_temp\"\" \"\"Cookies\"\" /NFL /NDL /NJH /NJS /nc /ns /np\")",
      "Bash(cmd //c start_chrome_debug.bat)",
      "Bash(cmd //c setup_ims_profile.bat)",
      "Bash(./setup_ims_profile.bat)",
      "Bash(cmd //c setup_ims_profile_v2.bat)",
      "Bash(./setup_ims_profile_v2.bat)",
      "Bash(uvicorn:*)",
      "Bash(git diff:*)",
      "Bash(git clone:*)",
      "Bash(git for-each-ref:*)",
      "Bash(git prune:*)",
      "Bash(npx msw:*)",
      "Bash(npx eslint:*)",
      "Bash(docker ps:*)",
      "Bash(TOKEN=\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJhY2YxYTQxYi04ODBjLTRkZWMtOTVhZC0xYjI1YWFkYWRjOTUiLCJ1c2VybmFtZSI6IlN5c3RlbSBBZG1pbmlzdHJhdG9yIiwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsInJvbGUiOiJhZG1pbiIsImV4cCI6MTc2Nzg0MDAxMH0.PRSJOXLpC5It-fFSJG4VJeSxok98sL31X8qDFddd01M\")",
      "Bash(timeout 30 curl:*)",
      "Bash(git stash:*)",
      "Bash(timeout 60 curl:*)",
      "Bash(timeout 90 curl:*)",
      "Bash(timeout:*)",
      "Bash(cmd //c \"taskkill /PID 20680 /F\")",
      "Bash(cmd //c \"taskkill /PID 22468 /F\")",
      "Bash(cmd //c \"taskkill /PID 36400 /F\")",
      "Bash(PGPASSWORD=ragpassword psql:*)",
      "Bash(docker-compose stop:*)",
      "Bash(docker-compose rm:*)",
      "Bash(docker-compose up:*)",
      "Bash(npx tsc:*)"
    ]
  }
}
