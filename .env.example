# ============================================================================
# KMS API Configuration
# ============================================================================
# Copy this file to .env and update ALL values marked as REQUIRED
#
# SECURITY WARNING:
# - NEVER commit .env files to version control
# - NEVER use the example values in production
# - Generate unique secrets for each environment
# ============================================================================

# ==================== Application ====================
# Set to "development" for dev mode, "production" for prod
APP_ENV=production
DEBUG=false
APP_NAME="KMS API"
APP_VERSION="1.0.0"

# ==================== Server ====================
HOST=0.0.0.0
PORT=8000
WORKERS=4

# ==================== CORS Origins ====================
# Comma-separated list of allowed origins
# SECURITY: Only include trusted domains in production
CORS_ORIGINS=http://localhost:3000,http://localhost:8501

# ============================================================================
# REQUIRED SECRETS - Application will fail to start without these
# ============================================================================

# -------------------- JWT Authentication --------------------
# REQUIRED: Minimum 32 characters
# Generate with: openssl rand -base64 32
JWT_SECRET_KEY=

# JWT Configuration
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# -------------------- Encryption Keys --------------------
# REQUIRED: Minimum 32 characters
# Generate with: openssl rand -base64 32
ENCRYPTION_MASTER_KEY=

# REQUIRED: Minimum 16 characters
# Generate with: openssl rand -base64 16
ENCRYPTION_SALT=

# -------------------- Neo4j Graph Database --------------------
# REQUIRED: Neo4j password
# SECURITY: Use a strong, unique password
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=

# -------------------- PostgreSQL Database --------------------
# Primary relational database for user data, sessions, and metadata
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=ragdb
POSTGRES_USER=raguser
POSTGRES_PASSWORD=ragpassword
# Connection pool settings
POSTGRES_POOL_SIZE=5
POSTGRES_MAX_OVERFLOW=10
# Alternative: Full connection string (overrides individual settings)
# DATABASE_URL=postgresql://raguser:ragpassword@localhost:5432/ragdb

# ============================================================================
# OPTIONAL SECRETS - Application will run without these but with reduced functionality
# ============================================================================

# -------------------- Admin User Initialization --------------------
# Set this to create an initial admin user at startup
# SECURITY: Minimum 12 characters, must not be a common password
# If not set, no admin user will be created automatically
# Generate with: openssl rand -base64 16
ADMIN_INITIAL_PASSWORD=
ADMIN_EMAIL=admin@localhost

# -------------------- Google OAuth (Optional) --------------------
# Required only if using Google SSO
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# -------------------- Corporate SSO (Optional) --------------------
# Comma-separated list of corporate email domains for SSO
# Use "*" to allow all domains (not recommended for production)
# Examples:
#   CORP_EMAIL_DOMAINS=company.com,company.co.kr
#   CORP_EMAIL_DOMAINS=*
CORP_EMAIL_DOMAINS=tmaxsoft.com,tmax.co.kr,tmaxsoft.co.jp,gmail.com

# -------------------- HashiCorp Vault (Optional) --------------------
# Set these to use Vault instead of environment variables for secrets
# VAULT_URL=https://vault.example.com:8200
# VAULT_TOKEN=

# ============================================================================
# LLM & Embedding Configuration
# ============================================================================

# LLM Configuration (Nemotron)
LLM_API_URL=http://localhost:12800/v1/chat/completions
LLM_MODEL=nvidia/nvidia-nemotron-nano-9b-v2

# Code LLM Configuration (Mistral NeMo)
CODE_LLM_API_URL=http://localhost:12802/v1/chat/completions
CODE_LLM_MODEL=mistralai/Mistral-Nemo-Instruct-2407
CODE_LLM_TEMPERATURE=0.1
CODE_LLM_MAX_TOKENS=2048

# Embedding Configuration (NeMo)
EMBEDDING_API_URL=http://localhost:12801/v1
EMBEDDING_MODEL=nvidia/nv-embedqa-mistral-7b-v2
EMBEDDING_DIMENSION=4096
EMBEDDING_BATCH_SIZE=32

# ============================================================================
# Vector & RAG Configuration
# ============================================================================

# Vector Index Configuration
VECTOR_INDEX_NAME=chunk_embedding
VECTOR_SIMILARITY_FUNCTION=cosine

# RAG Configuration
CHUNK_SIZE=1000
CHUNK_OVERLAP=200
DEFAULT_RAG_STRATEGY=auto
VECTOR_WEIGHT=0.5
TOP_K_RESULTS=5

# ============================================================================
# File Upload & Rate Limiting
# ============================================================================

# File Upload
MAX_UPLOAD_SIZE_MB=50
UPLOAD_DIR=./uploads

# Rate Limiting (requests per minute)
RATE_LIMIT_QUERY=60
RATE_LIMIT_UPLOAD=10
RATE_LIMIT_DEFAULT=120

# ============================================================================
# Quick Setup Guide
# ============================================================================
# 1. Copy this file: cp .env.example .env
# 2. Generate required secrets:
#    export JWT_SECRET_KEY=$(openssl rand -base64 32)
#    export ENCRYPTION_MASTER_KEY=$(openssl rand -base64 32)
#    export ENCRYPTION_SALT=$(openssl rand -base64 16)
#    export NEO4J_PASSWORD=$(openssl rand -base64 16)
#    export POSTGRES_PASSWORD=$(openssl rand -base64 16)
#    export ADMIN_INITIAL_PASSWORD=$(openssl rand -base64 16)
# 3. Update .env with generated values
# 4. Start PostgreSQL: cd test_postgressql && ./start.sh
# 5. Start GraphRAG services: cd docker && ./start-services.sh
# 6. Start the API: python -m uvicorn app.api.main:app --reload
# 7. Start the frontend: cd frontend && npm run dev
# ============================================================================
